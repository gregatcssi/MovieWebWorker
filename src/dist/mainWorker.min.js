var __extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},Character_Type;!function(t){t[t.NestEgg=0]="NestEgg",t[t.LifeInsurance=1]="LifeInsurance",t[t.Property=2]="Property",t[t.Debt=3]="Debt",t[t.Insurance=4]="Insurance",t[t.IncomeRiver=5]="IncomeRiver",t[t.Wef=6]="Wef",t[t.FromList=7]="FromList",t[t.Cost=8]="Cost",t[t.Distribution=9]="Distribution",t[t.ThirdParty=10]="ThirdParty",t[t.Growth=11]="Growth",t[t.CostDestination=12]="CostDestination",t[t.Income=13]="Income",t[t.Transfer=14]="Transfer",t[t.InheritanceCashAccount=15]="InheritanceCashAccount"}(Character_Type||(Character_Type={}));var Transfer_Type;!function(t){t[t.None=0]="None",t[t.Contribution=1]="Contribution",t[t.Distribution=2]="Distribution",t[t.Growth=3]="Growth",t[t.Cost=4]="Cost",t[t.Transfer=5]="Transfer",t[t.Premium=6]="Premium",t[t.LoanPayBack=7]="LoanPayBack"}(Transfer_Type||(Transfer_Type={}));var Month_Type;!function(t){t[t.January=0]="January",t[t.February=1]="February",t[t.March=2]="March",t[t.April=3]="April",t[t.May=4]="May",t[t.June=5]="June",t[t.July=6]="July",t[t.August=7]="August",t[t.September=8]="September",t[t.October=9]="October",t[t.November=10]="November",t[t.December=11]="December"}(Month_Type||(Month_Type={}));var Apr_Type;!function(t){t[t.Fixed=0]="Fixed",t[t.Variable=1]="Variable"}(Apr_Type||(Apr_Type={}));var Tax_Type;!function(t){t[t.PreTax=0]="PreTax",t[t.PostTax=1]="PostTax"}(Tax_Type||(Tax_Type={}));var Additional_Direction;!function(t){t[t.None=0]="None",t[t.Increasing=1]="Increasing",t[t.Decreasing=2]="Decreasing",t[t.Variable=3]="Variable"}(Additional_Direction||(Additional_Direction={}));var Additional_Direction_No_Variable;!function(t){t[t.None=0]="None",t[t.Increasing=1]="Increasing",t[t.Decreasing=2]="Decreasing"}(Additional_Direction_No_Variable||(Additional_Direction_No_Variable={}));var Income_Type;!function(t){t[t.Net=0]="Net",t[t.Gross=1]="Gross"}(Income_Type||(Income_Type={}));var Cost_Type;!function(t){t[t.Fee=0]="Fee",t[t.Tax=1]="Tax"}(Cost_Type||(Cost_Type={}));var CostSub_Type;!function(t){t[t.Select=0]="Select",t[t.Setup=1]="Setup",t[t.Regular=2]="Regular",t[t.EarlyDistribution=3]="EarlyDistribution",t[t.OverAmount=4]="OverAmount",t[t.APR=5]="APR",t[t.Surrender=6]="Surrender",t[t.PropertySale=7]="PropertySale",t[t.Borrow=8]="Borrow"}(CostSub_Type||(CostSub_Type={}));var DollarPctCompound_Type;!function(t){t[t.Dollar=0]="Dollar",t[t.Percentage=1]="Percentage"}(DollarPctCompound_Type||(DollarPctCompound_Type={}));var TaxTemplate_Type;!function(t){t[t.BasisThenGain=0]="BasisThenGain",t[t.GainThenBasis=1]="GainThenBasis",t[t.Exclusion_Ratio=2]="Exclusion_Ratio",t[t.Fully_Taxed=3]="Fully_Taxed",t[t.Tax_Free=4]="Tax_Free"}(TaxTemplate_Type||(TaxTemplate_Type={}));var TransferGrowthCost_Type;!function(t){t[t.Growth=0]="Growth",t[t.NetGrowth=1]="NetGrowth"}(TransferGrowthCost_Type||(TransferGrowthCost_Type={}));var TransferDistributionCost_Type;!function(t){t[t.Distribution=0]="Distribution",t[t.NetDistribution=1]="NetDistribution"}(TransferDistributionCost_Type||(TransferDistributionCost_Type={}));var TransferIncomeCost_Type;!function(t){t[t.Income=0]="Income",t[t.NetIncome=1]="NetIncome"}(TransferIncomeCost_Type||(TransferIncomeCost_Type={}));var WithdrawalBorrow_Type;!function(t){t[t.Withdraw=0]="Withdraw",t[t.Borrow=1]="Borrow"}(WithdrawalBorrow_Type||(WithdrawalBorrow_Type={}));var AmountSpendDown_Type;!function(t){t[t.Amount=0]="Amount",t[t.SpendDown=1]="SpendDown"}(AmountSpendDown_Type||(AmountSpendDown_Type={}));var Mode_Type;!function(t){t[t.Daily=0]="Daily",t[t.Biweekly=1]="Biweekly",t[t.Weekly=2]="Weekly",t[t.Bimonthly=3]="Bimonthly",t[t.Monthly=4]="Monthly",t[t.Quarterly=5]="Quarterly",t[t.Semiannual=6]="Semiannual",t[t.Annual=7]="Annual"}(Mode_Type||(Mode_Type={}));var LoanPayBack_Type;!function(t){t[t.Income=0]="Income",t[t.Accrual=1]="Accrual"}(LoanPayBack_Type||(LoanPayBack_Type={}));var LoanPaymentMethod_Type;!function(t){t[t.PIImmediately=0]="PIImmediately",t[t.DeferPI=1]="DeferPI",t[t.IOOnly=2]="IOOnly",t[t.IOThenPI=3]="IOThenPI"}(LoanPaymentMethod_Type||(LoanPaymentMethod_Type={}));var Beneficiary_Type;!function(t){t[t.Primary=0]="Primary",t[t.Contingent=1]="Contingent",t[t.Tertiary=2]="Tertiary",t[t.Quaternary=3]="Quaternary",t[t.Quinary=4]="Quinary"}(Beneficiary_Type||(Beneficiary_Type={}));var BeneficiaryPayout_Type;!function(t){t[t.LumpSum=0]="LumpSum",t[t.OverYears=1]="OverYears",t[t.Installments=2]="Installments"}(BeneficiaryPayout_Type||(BeneficiaryPayout_Type={}));var BaseClass=function(){function t(){}return t}(),Movie=function(t){function e(){t.apply(this,arguments),this.TimeLines=[],this.TransferCharacters=[]}return __extends(e,t),e}(BaseClass),BaseClassWithAges=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e}(BaseClass),TimeLine=function(t){function e(){t.apply(this,arguments),this.NestEggs=[],this.ThirdParties=[],this.HardAssets=[],this.Debts=[],this.AnnuityWithIncomeRiders=[],this.TermLifes=[],this.PermLifes=[],this.IncomeRivers=[],this.Insurances=[]}return __extends(e,t),e}(BaseClassWithAges),Transfers=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e}(BaseClassWithAges),UiTransferCharacter=function(t){function e(){t.apply(this,arguments),this.VariableSchedule=[],this.EarlyDistributionAge=59.5}return __extends(e,t),e}(BaseClassWithAges),Cost=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e}(UiTransferCharacter),Contribution=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e}(UiTransferCharacter),Growth=function(t){function e(){t.apply(this,arguments),this.Costs=[]}return __extends(e,t),e}(UiTransferCharacter),Distribution=function(t){function e(){t.apply(this,arguments),this.Costs=[]}return __extends(e,t),e}(UiTransferCharacter),Beneficiary=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e}(UiTransferCharacter),TransferCharacter=function(t){function e(){t.apply(this,arguments),this.SourceTimeLineCharacters=[],this.DestinationTimeLineCharacters=[]}return __extends(e,t),e}(Distribution),LoanPayBack=function(t){function e(){t.apply(this,arguments),this.LoanVariableScheduleApr=[]}return __extends(e,t),e}(UiTransferCharacter),CharacterBase=function(t){function e(){t.apply(this,arguments),this.VariableSchedule=[],this.Contributions=[],this.Growths=[],this.GrowthAges=[],this.SetupFees=[],this.Distributions=[],this.Beneficiaries=[]}return __extends(e,t),e}(BaseClassWithAges),NestEgg=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e}(CharacterBase),AnnuityWithIncomeRider=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e}(CharacterBase),Insurance=function(t){function e(){t.apply(this,arguments),this.DefensePremiumVariableSchedule=[]}return __extends(e,t),e}(CharacterBase),ThirdParty=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e}(CharacterBase),IncomeRiver=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e}(CharacterBase),PermLife=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e}(CharacterBase),TermLife=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e}(CharacterBase),Debt=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e}(CharacterBase),HardAsset=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e}(CharacterBase),InheritanceCashAccount=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e}(CharacterBase),AgeAvailable=function(){function t(){}return t}(),VariableSchedule=function(){function t(){}return t}(),CostDestination=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e}(BaseClass),TimeLineCharacter=function(){function t(){}return t}();self.onmessage=function(t){switch(t.data.tag){case"FullMovie":postMessage("Gone away for now");break;case"Nestegg":var e=new NestEggScheduler(t.data.nestegg);e.updateContributionSchedule(),postMessage("Gone away for now");break;default:postMessage("i want to test multiple posts"),postMessage("testing new setup")}};var NestEggScheduler=function(){function t(t){this._contributions=[],this._distributions=[],this._setupFees=[],this._growths=[],this._contributions=t.Contributions,this._distributions=t.Distributions,this._growths=t.Growths,this._setupFees=t.SetupFees}return t.prototype.updateContributionSchedule=function(){return"this is for sandboxed update to contribution since it's value isn't altered by anything other than no more money"},t}(),UtilService=function(){function t(){}return t.prototype.GetAccurateAge=function(t,e){var r=e.getMonth()-t.getMonth(),i=e.getDate()-t.getDate();i<0&&r--;var n=e.getFullYear()-t.getFullYear();return r<0&&n--,new Date(n,r,i)},t.prototype.GetMonthDifference=function(t,e){var r=12*(t.getFullYear()-e.getFullYear())+t.getMonth()-e.getMonth();return Math.abs(r)},t.prototype.GetDateAtAge=function(t,e){var r=t.getFullYear(),i=r+e;return new Date(i,t.getMonth(),t.getDate())},t.prototype.AddYearsToDate=function(t,e){var r=t.getFullYear(),i=r+e;return new Date(i,t.getMonth(),t.getDate())},t.prototype.GetAge=function(t,e){var r=e.getDate()-t.getDate(),i=e.getMonth()-t.getMonth(),n=e.getFullYear()-t.getFullYear();return r<0&&i--,i<0?n--:i>=6&&n++,n},t.prototype.GetAgeOfSecondTimeLineById=function(t,e,r,i){var n=t.TimeLines.map(function(t){return t.Id}).indexOf(e);if(n>=0){var a=t.TimeLines.map(function(t){return t.Id}).indexOf(r);if(a>=0){var o=t.TimeLines[n],s=t.TimeLines[a];return this.GetAgeOfSecondTimeLine(o,s,i)}}return-1},t.prototype.GetAgeOfSecondTimeLine=function(t,e,r){var i=t.DateOfBirth,n=this.AddYearsToDate(i,r),a=e.DateOfBirth,o=this.GetAge(a,n);return o},t.prototype.GetStartAgeRange=function(t){var e=[],r=t.StartAge,i=1e3;t.EndAge<=1e3&&(i=t.EndAge);for(var n=0;n<=i;n++)e.push(n),n<r&&n+1>r&&e.push(r);return e},t.prototype.GetEndAgeRange=function(t){var e=[];void 0==t.StartAge&&(t.StartAge=0);for(var r=t.StartAge,i=1e3,n=0,a=r;a<=i;a++)e.push(a),0==n&&(a=parseInt(a.toString())),n++;return e},t.prototype.GetEarlyDeathAgeRange=function(t){var e=[];void 0==t.StartAge&&(t.StartAge=0);for(var r=t.StartAge,i=t.EndAge,n=0,a=r;a<=i;a++)e.push(a),0==n&&(a=parseInt(a.toString())),n++;return e},t.prototype.anotherClone=function(t){var e={};for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e},t.prototype.GenerateGuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0,r="x"===t?e:3&e|8;return r.toString(16)})},t}(),ContributionUtil=function(){function t(){this._contribution=new Contribution,this._utilsvc=new UtilService}return t.prototype.setcontribution=function(t){this._contribution=t},t.prototype.calculateContributions=function(){var t=[],e=this._contribution.BaseValue;switch(this._contribution.BaseDirection){case Additional_Direction.None:for(var r=this._contribution.StartAge;r<this._contribution.EndAge;r++){var i=new Transfers;i.SourceId=this._contribution.SourceId,i.DestinationId=this._contribution.DestinationId,i.DeltaDollar=this._contribution.BaseValue,i.CurrentAge=r,i.Id=this._utilsvc.GenerateGuid();var n=this._utilsvc.anotherClone(i);t.push(n)}break;case Additional_Direction.Increasing:for(var r=this._contribution.StartAge;r<this._contribution.EndAge;r++){var a=this.increasingContribution(r,e);e=a.previousval;var i=a.tmpTransfer,n=this._utilsvc.anotherClone(i);t.push(n)}break;case Additional_Direction.Decreasing:for(var r=this._contribution.StartAge;r<this._contribution.EndAge;r++){var a=this.decreasingContribution(r,e);e=a.previousval;var i=a.tmpTransfer,n=this._utilsvc.anotherClone(i);t.push(n)}break;case Additional_Direction.Variable:for(var r=this._contribution.StartAge;r<this._contribution.EndAge;r++){var a=this.variableContribution(r,e);e=a.previousval;var i=a.tmpTransfer,n=this._utilsvc.anotherClone(i);t.push(n)}}return t},t.prototype.increasingContribution=function(t,e){var r=new Transfers;switch(r.SourceId=this._contribution.SourceId,r.DestinationId=this._contribution.DestinationId,r.Id=this._utilsvc.GenerateGuid(),this._contribution.AdditionalType){case DollarPctCompound_Type.Percentage:e=r.DeltaDollar=e+e*this._contribution.AdditionalValue,r.CurrentAge=t;break;default:e=r.DeltaDollar=e+this._contribution.AdditionalValue,r.CurrentAge=t}return{tmpTransfer:r,previousval:e}},t.prototype.decreasingContribution=function(t,e){var r=new Transfers;switch(r.SourceId=this._contribution.SourceId,r.DestinationId=this._contribution.DestinationId,r.Id=this._utilsvc.GenerateGuid(),this._contribution.AdditionalType){case DollarPctCompound_Type.Percentage:e=r.DeltaDollar=e-e*this._contribution.AdditionalValue,r.CurrentAge=t;break;default:e=r.DeltaDollar=e-this._contribution.AdditionalValue,r.CurrentAge=t}return{tmpTransfer:r,previousval:e}},t.prototype.variableContribution=function(t,e){var r=new Transfers;r.SourceId=this._contribution.SourceId,r.DestinationId=this._contribution.DestinationId,r.Id=this._utilsvc.GenerateGuid();var i=this._contribution.VariableSchedule.map(function(t){return t.Age}).indexOf(t);switch(this._contribution.AdditionalType){case DollarPctCompound_Type.Percentage:e=r.DeltaDollar=e+e*this._contribution.VariableSchedule[i].CompoundPct,r.CurrentAge=t;break;default:e=r.DeltaDollar=e+this._contribution.VariableSchedule[i].Dollar,r.CurrentAge=t}return{tmpTransfer:r,previousval:e}},t}(),CostsUtil=function(){function t(){}return t}(),DistributionUtil=function(){function t(){this._distribution=new Distribution,this._utilsvc=new UtilService}return t.prototype.setDistribution=function(t){this._distribution=t},t.prototype.calculateDistributions=function(){var t=[],e=this._distribution.BaseValue;switch(this._distribution.BaseDirection){case Additional_Direction.None:for(var r=this._distribution.StartAge;r<this._distribution.EndAge;r++){var i=new Transfers;i.SourceId=this._distribution.SourceId,i.DestinationId=this._distribution.DestinationId,i.DeltaDollar=this._distribution.BaseValue,i.CurrentAge=r,i.Id=this._utilsvc.GenerateGuid();var n=this._utilsvc.anotherClone(i);t.push(n)}break;case Additional_Direction.Increasing:for(var r=this._distribution.StartAge;r<this._distribution.EndAge;r++){var a=this.increasingDistribution(r,e);e=a.previousval;var i=a.tmpDistribution,n=this._utilsvc.anotherClone(i);t.push(n)}break;case Additional_Direction.Decreasing:for(var r=this._distribution.StartAge;r<this._distribution.EndAge;r++){var a=this.decreasingDistribution(r,e);e=a.previousval;var i=a.tmpDistribution,n=this._utilsvc.anotherClone(i);t.push(n)}break;case Additional_Direction.Variable:for(var r=this._distribution.StartAge;r<this._distribution.EndAge;r++){var a=this.variableDistribution(r,e);e=a.previousval;var i=a.tmpDistribution,n=this._utilsvc.anotherClone(i);t.push(n)}}return t},t.prototype.increasingDistribution=function(t,e){var r=new Transfers;switch(r.SourceId=this._distribution.SourceId,r.DestinationId=this._distribution.DestinationId,r.Id=this._utilsvc.GenerateGuid(),this._distribution.AdditionalType){case DollarPctCompound_Type.Percentage:e=r.DeltaDollar=e+e*this._distribution.AdditionalValue,r.CurrentAge=t;break;default:e=r.DeltaDollar=e+this._distribution.AdditionalValue,r.CurrentAge=t}return{tmpDistribution:r,previousval:e}},t.prototype.decreasingDistribution=function(t,e){var r=new Transfers;switch(r.SourceId=this._distribution.SourceId,r.DestinationId=this._distribution.DestinationId,r.Id=this._utilsvc.GenerateGuid(),this._distribution.AdditionalType){case DollarPctCompound_Type.Percentage:e=r.DeltaDollar=e-e*this._distribution.AdditionalValue,r.CurrentAge=t;break;default:e=r.DeltaDollar=e-this._distribution.AdditionalValue,r.CurrentAge=t}return{tmpDistribution:r,previousval:e}},t.prototype.variableDistribution=function(t,e){var r=new Transfers;r.SourceId=this._distribution.SourceId,r.DestinationId=this._distribution.DestinationId,r.Id=this._utilsvc.GenerateGuid();var i=this._distribution.VariableSchedule.map(function(t){return t.Age}).indexOf(t);switch(this._distribution.AdditionalType){case DollarPctCompound_Type.Percentage:e=r.DeltaDollar=e+e*this._distribution.VariableSchedule[i].CompoundPct,r.CurrentAge=t;break;default:e=r.DeltaDollar=e+this._distribution.VariableSchedule[i].Dollar,r.CurrentAge=t}return{tmpDistribution:r,previousval:e}},t}(),GrowthsUtil=function(){function t(){}return t}(),TransfersUtil=function(){function t(){this._transfer=new UiTransferCharacter,this._utilsvc=new UtilService}return t.prototype.setTransfer=function(t){this._transfer=t},t.prototype.calculateTransfers=function(){var t=[],e=this._transfer.BaseValue;switch(this._transfer.BaseDirection){case Additional_Direction.None:for(var r=this._transfer.StartAge;r<this._transfer.EndAge;r++){var i=new Transfers;i.SourceId=this._transfer.SourceId,i.DestinationId=this._transfer.DestinationId,i.DeltaDollar=this._transfer.BaseValue,i.CurrentAge=r,i.Id=this._utilsvc.GenerateGuid();var n=this._utilsvc.anotherClone(i);t.push(n)}break;case Additional_Direction.Increasing:for(var r=this._transfer.StartAge;r<this._transfer.EndAge;r++){var a=this.increasingTransfer(r,e);e=a.previousval;var i=a.tmpTransfer,n=this._utilsvc.anotherClone(i);t.push(n)}break;case Additional_Direction.Decreasing:for(var r=this._transfer.StartAge;r<this._transfer.EndAge;r++){var a=this.decreasingTransfer(r,e);e=a.previousval;var i=a.tmpTransfer,n=this._utilsvc.anotherClone(i);t.push(n)}break;case Additional_Direction.Variable:for(var r=this._transfer.StartAge;r<this._transfer.EndAge;r++){var a=this.variableTransfer(r,e);e=a.previousval;var i=a.tmpTransfer,n=this._utilsvc.anotherClone(i);t.push(n)}}return t},t.prototype.increasingTransfer=function(t,e){var r=new Transfers;switch(r.SourceId=this._transfer.SourceId,r.DestinationId=this._transfer.DestinationId,r.Id=this._utilsvc.GenerateGuid(),this._transfer.AdditionalType){case DollarPctCompound_Type.Percentage:e=r.DeltaDollar=e+e*this._transfer.AdditionalValue,r.CurrentAge=t;break;default:e=r.DeltaDollar=e+this._transfer.AdditionalValue,r.CurrentAge=t}return{tmpTransfer:r,previousval:e}},t.prototype.decreasingTransfer=function(t,e){var r=new Transfers;switch(r.SourceId=this._transfer.SourceId,r.DestinationId=this._transfer.DestinationId,r.Id=this._utilsvc.GenerateGuid(),this._transfer.AdditionalType){case DollarPctCompound_Type.Percentage:e=r.DeltaDollar=e-e*this._transfer.AdditionalValue,r.CurrentAge=t;break;default:e=r.DeltaDollar=e-this._transfer.AdditionalValue,r.CurrentAge=t}return{tmpTransfer:r,previousval:e}},t.prototype.variableTransfer=function(t,e){var r=new Transfers;r.SourceId=this._transfer.SourceId,r.DestinationId=this._transfer.DestinationId,r.Id=this._utilsvc.GenerateGuid();var i=this._transfer.VariableSchedule.map(function(t){return t.Age}).indexOf(t);switch(this._transfer.AdditionalType){case DollarPctCompound_Type.Percentage:e=r.DeltaDollar=e+e*this._transfer.VariableSchedule[i].CompoundPct,r.CurrentAge=t;break;default:e=r.DeltaDollar=e+this._transfer.VariableSchedule[i].Dollar,r.CurrentAge=t}return{tmpTransfer:r,previousval:e}},t}();